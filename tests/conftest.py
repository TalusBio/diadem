import numpy as np
import pytest
from ms2ml import Peptide


@pytest.fixture
def sample_peaks():
    """Sample predicted peaks for a single peptide."""
    VPQVSTPTLVEVSR_peaks = [  # noqa
        [175.118952167, 0.11523687839508057],
        [197.12845446699998, 0.12554128468036652],
        [262.150980167, 0.04191524535417557],
        [325.187032467, 0.6335505247116089],
        [361.219394167, 0.10234244912862778],
        [424.255446467, 0.10666630417108536],
        [490.26198716700003, 0.07077749073505402],
        [511.28747446700004, 0.017693039029836655],
        [589.330401167, 0.06628052890300751],
        [612.335153467, 0.009312867186963558],
        [702.414465167, 0.039480481296777725],
        [803.462144167, 0.04876701161265373],
        [900.514908167, 0.9805850386619568],
        [923.5196604670001, 0.0028175432235002518],
        [1001.5625871670001, 0.28157711029052734],
        [1022.5880744670001, 0.0011550436029210687],
        [1088.5946151670003, 1.0],
        [1151.6306674670002, 0.0010816878639161587],
        [1187.6630291670003, 0.538184642791748],
        [1315.7216071670005, 0.2381279170513153],
        [1337.7311094670004, 0.0012506503844633698],
        [1412.7743711670005, 0.017968058586120605],
        [402.234710317, 0.0010723050218075514],
        [450.761092317, 0.033703941851854324],
        [462.26346846700005, 0.0010208424646407366],
        [501.28493181700003, 0.0032511476892977953],
        [658.3644418170002, 0.0019166009733453393],
        [706.8908238170002, 0.1397942751646042],
    ]
    mzs = np.array([x[0] for x in VPQVSTPTLVEVSR_peaks])
    ints = np.array([x[1] for x in VPQVSTPTLVEVSR_peaks])
    z2_mass = 756.4250
    return mzs, ints, z2_mass


@pytest.fixture
def albumin_peptides():
    """All the peptides with charge 2 of the albumin tryptic digest."""
    ALBUMIN_PEPTIDE_SEQS = [  # noqa
        "SEVAHR",
        "DLGEENFK",
        "ALVLIAFAQYLQQCPFEDHVK",
        "LVNEVTEFAK",
        "TCVADESAENCDK",
        "SLHTLFGDK",
        "LCTVATLR",
        "ETYGEMADCCAK",
        "NECFLQHK",
        "DDNPNLPR",
        "LVRPEVDVMCTAFHDNEETFLK",
        "YLYEIAR",
        "HPYFYAPELLFFAK",
        "AAFTECCQAADK",
        "AACLLPK",
        "CASLQK",
        "AWAVAR",
        "AEFAEVSK",
        "LVTDLTK",
        "VHTECCHGDLLECADDR",
        "YICENQDSISSK",
        "ECCEKPLLEK",
        "NYAEAK",
        "DVFLGMFLYEYAR",
        "HPDYSVVLLLR",
        "TYETTLEK",
        "CCAAADPHECYAK",
        "VFDEFKPLVEEPQNLIK",
        "QNCELFEQLGEYK",
        "FQNALLVR",
        "VPQVSTPTLVEVSR",
        "MPCAEDYLSVVLNQLCVLHEK",
        "TPVSDR",
        "CCTESLVNR",
        "RPCFSALEVDETYVPK",
        "EFNAETFTFHADICTLSEK",
        "QTALVELVK",
        "AVMDDFAAFVEK",
        "ETCFAEEGK",
        "LVAASQAALGLSEVAHR",
        "DLGEENFK",
        "ALVLIAFAQYLQQCPFEDHVK",
        "LVNEVTEFAK",
        "TCVADESAENCDK",
        "SLHTLFGDK",
        "LCTVATLR",
        "ETYGEMADCCAK",
        "NECFLQHK",
        "DDNPNLPR",
        "LVRPEVDVMCTAFHDNEETFLK",
        "YLYEIAR",
        "HPYFYAPELLFFAK",
        "AAFTECCQAADK",
        "AACLLPK",
        "CASLQK",
        "AWAVAR",
        "AEFAEVSK",
        "LVTDLTK",
        "VHTECCHGDLLECADDR",
        "YICENQDSISSK",
        "ECCEKPLLEK",
        "NYAEAK",
        "DVFLGMFLYEYAR",
        "HPDYSVVLLLR",
        "TYETTLEK",
        "CCAAADPHECYAK",
        "VFDEFKPLVEEPQNLIK",
        "QNCELFEQLGEYK",
        "FQNALLVR",
        "VPQVSTPTLVEVSR",
        "MPCAEDYLSVVLNQLCVLHEK",
        "TPVSDR",
        "CCTESLVNR",
        "RPCFSALEVDETYVPK",
        "EFNAETFTFHADICTLSEK",
        "QTALVELVK",
        "AVMDDFAAFVEK",
        "ETCFAEEGK",
        "SEVAHR",
        "DLGEENFK",
        "ALVLIAFAQYLQQCPFEDHVK",
        "LVNEVTEFAK",
        "TCVADESAENCDK",
        "SLHTLFGDK",
        "LCTVATLR",
        "ETYGEMADCCAK",
        "NECFLQHK",
        "DDNPNLPR",
        "LVRPEVDVMCTAFHDNEETFLK",
        "YLYEIAR",
        "HPYFYAPELLFFAK",
        "AAFTECCQAADK",
        "AACLLPK",
        "CASLQK",
        "AWAVAR",
        "AEFAEVSK",
        "LVTDLTK",
        "VHTECCHGDLLECADDR",
        "YICENQDSISSK",
        "ECCEKPLLEK",
        "NYAEAK",
        "DVFLGMFLYEYAR",
        "HPDYSVVLLLR",
        "TYETTLEK",
        "CCAAADPHECYAK",
        "VFDEFKPLVEEPQNLIK",
        "QNCELFEQLGEYK",
        "FQNALLVR",
        "VPQVSTPTLVEVSR",
        "MPCAEDYLSVVLNQLCVLHEK",
        "TPVSDR",
        "CCTESLVNR",
        "RPCFSALEVDETYVPK",
        "EFNAETFTFHADICTLSEK",
        "QTALVELVK",
        "AVMDDFAAFVEK",
        "ETCFAEEGK",
        "LVAASQAALGLLVAASQAALGL",
    ]

    out = [Peptide.from_proforma_seq(f"{x}/2") for x in ALBUMIN_PEPTIDE_SEQS]
    return out
